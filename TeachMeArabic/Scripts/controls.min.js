angular.module("com.2fdevs.videogular.plugins.controls",[]).directive("vgControls",["$timeout","VG_STATES","VG_EVENTS",function(d,a,b){return{restrict:"E",require:"^videogular",transclude:!0,template:'<div id="controls-container" ng-show="isReady" ng-class="animationClass" ng-transclude></div>',scope:{autoHide:"=vgAutohide",autoHideTime:"=vgAutohideTime"},link:function(a,c,f,e){function k(){n();a.$apply()}function l(){a.animationClass="hide-animation"}function n(){a.animationClass="show-animation";
d.cancel(g);a.autoHide&&(g=d(l,q))}function r(){var a=e.getSize();c.css("top",parseInt(a.height,10)-parseInt(s,10)+"px");m=d(u,500)}function u(){d.cancel(m);a.isReady=!0}var t=0,q=2E3,s=c[0].style.height,g,m;a.isReady=!1;void 0!=a.autoHide&&a.$watch("autoHide",function(b){b?(a.animationClass="hide-animation",e.videogularElement.bind("mousemove",k)):(a.animationClass="",d.cancel(g),e.videogularElement.unbind("mousemove",k),n())});void 0!=a.autoHideTime&&a.$watch("autoHideTime",function(a){q=a});e.$on(b.ON_UPDATE_SIZE,
function(a,e){t=e[1];c.css("top",parseInt(t,10)-parseInt(s,10)+"px")});e.isPlayerReady()?r():e.$on(b.ON_PLAYER_READY,r)}}}]).directive("vgPlayPauseButton",["VG_STATES","VG_EVENTS",function(d,a){return{restrict:"E",require:"^videogular",template:"<div class='iconButton'>{{currentIcon}}</div>",scope:{vgPlayIcon:"=",vgPauseIcon:"="},controller:function(a){a.currentIcon=$.parseHTML(a.vgPlayIcon)[0].data},link:function(b,h,c,f){h.bind("click",function(){f.playPause()});f.$on(a.ON_SET_STATE,function(a,
k){switch(k[0]){case d.PLAY:b.currentIcon=$.parseHTML(b.vgPauseIcon)[0].data;break;case d.PAUSE:b.currentIcon=$.parseHTML(b.vgPlayIcon)[0].data;break;case d.STOP:b.currentIcon=$.parseHTML(b.vgPlayIcon)[0].data}})}}}]).directive("vgTimedisplay",["VG_EVENTS",function(d){return{require:"^videogular",restrict:"E",link:function(a,b,h,c){function f(a){var b=Math.floor(a/60);a=Math.floor(a-60*b);return{mins:10>b?"0"+b:b,secs:10>a?"0"+a:a}}a.currentTime="00:00";a.totalTime="00:00";c.$on(d.ON_START_PLAYING,
function(b,c){var d=f(c[0]);a.totalTime=d.mins+":"+d.secs});c.$on(d.ON_UPDATE_TIME,function(b,c){var d=f(c[0]);a.currentTime=d.mins+":"+d.secs});c.$on(d.ON_COMPLETE,function(b,c){a.currentTime="00:00"})}}}]).directive("vgScrubbar",["VG_EVENTS","VG_STATES","VG_UTILS",function(d,a,b){return{restrict:"AE",require:"^videogular",replace:!0,link:function(h,c,f,e){function k(a){var d=a.originalEvent.touches;v=b.isiOSDevice()?-1*(d[0].clientX-a.originalEvent.layerX):a.originalEvent.layerX;a=d[0].clientX+
v-d[0].target.offsetLeft;g=!0;m&&(p=!0);e.seekTime(a*e.videoElement[0].duration/c[0].scrollWidth);e.pause()}function l(a){p&&(p=!1,e.play());g=!1}function n(a){a=a.originalEvent.touches;g&&(a=a[0].clientX+v-a[0].target.offsetLeft,e.seekTime(a*e.videoElement[0].duration/c[0].scrollWidth))}function r(a){g=!1}function u(a){a=b.fixEventOffset(a);g=!0;m&&(p=!0);e.seekTime(a.offsetX*e.videoElement[0].duration/c[0].scrollWidth);e.pause()}function t(a){a=b.fixEventOffset(a);p&&(p=!1,e.play());g=!1;e.seekTime(a.offsetX*
e.videoElement[0].duration/c[0].scrollWidth)}function q(a){g&&(a=b.fixEventOffset(a),e.seekTime(a.offsetX*e.videoElement[0].duration/c[0].scrollWidth))}function s(a){g=!1}var g=!1,m=!1,p=!1,v=0;e.$on(d.ON_SET_STATE,function(b,c){if(!g)switch(c[0]){case a.PLAY:m=!0;break;case a.PAUSE:m=!1;break;case a.STOP:m=!1}});b.isMobileDevice()?(c.bind("touchstart",k),c.bind("touchend",l),c.bind("touchmove",n),c.bind("touchleave",r)):(c.bind("mousedown",u),c.bind("mouseup",t),c.bind("mousemove",q),c.bind("mouseleave",
s))}}}]).directive("vgScrubbarcurrenttime",["VG_EVENTS",function(d){return{restrict:"E",require:"^videogular",link:function(a,b,h,c){var f=0;c.$on(d.ON_UPDATE_TIME,function(a,c){f=Math.round(c[0]/c[1]*100);b.css("width",f+"%")});c.$on(d.ON_COMPLETE,function(a,c){f=0;b.css("width",f+"%")})}}}]).directive("vgVolume",["VG_UTILS",function(d){return{restrict:"E",link:function(a,b,h){function c(){a.volumeVisibility="visible";a.$apply()}function f(){a.volumeVisibility="hidden";a.$apply()}d.isMobileDevice()?
b.css("display","none"):(a.volumeVisibility="hidden",b.bind("mouseover",c),b.bind("mouseleave",f))}}}]).directive("vgVolumebar",["VG_EVENTS","VG_UTILS",function(d,a){return{restrict:"E",require:"^videogular",template:"<div class='verticalVolumeBar'><div class='volumeBackground'><div class='volumeValue'></div><div class='volumeClickArea'></div></div></div>",link:function(b,h,c,f){function e(a){n.css("height",a+"%");n.css("top",100-a+"%")}var k=!1,l=angular.element(h[0].getElementsByClassName("volumeBackground")),
n=angular.element(h[0].getElementsByClassName("volumeValue"));h.css("visibility",b.volumeVisibility);b.$watch("volumeVisibility",function(a){h.css("visibility",a)});l.bind("click",function(b){b=a.fixEventOffset(b);var c=parseInt(l.prop("offsetHeight"));b=100*b.offsetY/c;c=1-b/100;e(b);f.setVolume(c)});l.bind("mousedown",function(a){k=!0});l.bind("mouseup",function(a){k=!1});l.bind("mousemove",function(b){if(k){b=a.fixEventOffset(b);var c=parseInt(l.prop("offsetHeight"));b=100*b.offsetY/c;c=1-b/100;
e(b);f.setVolume(c)}});l.bind("mouseleave",function(a){k=!1});f.$on(d.ON_SET_VOLUME,function(a,b){e(100*b[0])})}}}]).directive("vgMutebutton",["VG_EVENTS",function(d){return{restrict:"E",require:"^videogular",scope:{vgVolumeLevel3Icon:"=",vgVolumeLevel2Icon:"=",vgVolumeLevel1Icon:"=",vgVolumeLevel0Icon:"=",vgMuteIcon:"="},controller:function(a){a.muteIcon=$.parseHTML(a.vgMuteIcon)[0].data;a.volumeLevel0Icon=$.parseHTML(a.vgVolumeLevel0Icon)[0].data;a.volumeLevel1Icon=$.parseHTML(a.vgVolumeLevel1Icon)[0].data;
a.volumeLevel2Icon=$.parseHTML(a.vgVolumeLevel2Icon)[0].data;a.volumeLevel3Icon=$.parseHTML(a.vgVolumeLevel3Icon)[0].data;a.currentIcon=a.volumeLevel3Icon},template:"<div class='iconButton'>{{currentIcon}}</div>",link:function(a,b,h,c){a.defaultVolume=1;a.currentVolume=a.defaultVolume;b.bind("click",function(b){a.currentIcon==a.muteIcon?a.currentVolume=a.defaultVolume:(a.currentVolume=0,a.currentIcon=a.muteIcon);c.setVolume(a.currentVolume)});c.$on(d.ON_SET_VOLUME,function(b,c){a.currentVolume=c[0];
a.currentIcon!=a.muteIcon?a.defaultVolume=c[0]:0<c[0]&&(a.defaultVolume=c[0]);var d=Math.round(100*c[0]);0==d?a.currentIcon=a.muteIcon:0<d&&25>d?a.currentIcon=a.volumeLevel0Icon:25<=d&&50>d?a.currentIcon=a.volumeLevel1Icon:50<=d&&75>d?a.currentIcon=a.volumeLevel2Icon:75<=d&&(a.currentIcon=a.volumeLevel3Icon);a.$apply()})}}}]).directive("vgFullscreenbutton",["$window","VG_EVENTS",function(d,a){return{restrict:"AE",require:"^videogular",scope:{vgEnterFullScreenIcon:"=",vgExitFullScreenIcon:"="},controller:function(a){a.enterFullScreenIcon=
$.parseHTML(a.vgEnterFullScreenIcon)[0].data;a.exitFullScreenIcon=$.parseHTML(a.vgExitFullScreenIcon)[0].data;a.currentIcon=a.enterFullScreenIcon},template:"<div class='iconButton'>{{currentIcon}}</div>",link:function(b,d,c,f){d.bind("click",function(a){f.toggleFullScreen()});f.$on(a.ON_ENTER_FULLSCREEN,function(){b.fullscreenIcon=b.exitFullScreenIcon});f.$on(a.ON_EXIT_FULLSCREEN,function(){b.fullscreenIcon=b.enterFullScreenIcon})}}}]);